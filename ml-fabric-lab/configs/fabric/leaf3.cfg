!
! ==========================================================
! LEAF3
! - Role: VTEP leaf (no hosts attached)
! ==========================================================
!
service routing protocols model multi-agent
hostname leaf3
username admin privilege 15 secret 0 admin
aaa authorization exec default local
management api http-commands
   no shutdown
!
vrf instance MGMT
ip routing vrf MGMT
!
interface Management0
   vrf MGMT
   ip address 172.20.20.23/24
   no shutdown
!
ip route vrf MGMT 0.0.0.0/0 172.20.20.1
!
snmp-server vrf MGMT
snmp-server community lab ro
!
ip routing
router general
   router-id ipv4 10.0.0.13
!
vlan 10
   name TENANT10
!
interface Loopback0
   ip address 10.0.0.13/32
interface Loopback1
   ip address 10.0.1.13/32
!
interface Ethernet1
   description to-spine1-eth5
   no switchport
   mtu 9214
   ip address 172.16.0.16/31
   no shutdown
interface Ethernet2
   description to-spine2-eth5
   no switchport
   mtu 9214
   ip address 172.16.0.20/31
   no shutdown
!
interface Vxlan1
   vxlan source-interface Loopback1
   vxlan udp-port 4789
   vxlan vlan 10 vni 10010
!
router bgp 65103
   router-id 10.0.0.13
   !
   vlan 10
      rd 10.0.0.13:10010
      route-target import 65000:10010
      route-target export 65000:10010
      redistribute learned
   !
   neighbor UNDERLAY peer group
   neighbor UNDERLAY description UNDERLAY_EBGP_TO_SPINES
   neighbor UNDERLAY remote-as 65000
   neighbor UNDERLAY maximum-routes 12000
   !
   neighbor OVERLAY peer group
   neighbor OVERLAY description OVERLAY_EVPN_EBGP_TO_SPINES
   neighbor OVERLAY remote-as 65000
   neighbor OVERLAY update-source Loopback0
   neighbor OVERLAY ebgp-multihop 3
   neighbor OVERLAY send-community extended
   neighbor OVERLAY maximum-routes 12000
   !
   neighbor 172.16.0.17 peer group UNDERLAY
   neighbor 172.16.0.21 peer group UNDERLAY
   !
   neighbor 10.0.0.1 peer group OVERLAY
   neighbor 10.0.0.2 peer group OVERLAY
   !
   address-family ipv4
      neighbor UNDERLAY activate
      network 10.0.0.13/32
      network 10.0.1.13/32
   !
   address-family evpn
      neighbor OVERLAY activate
!
management api http-commands
   protocol http
   !
   vrf MGMT
      no shutdown

management api gnmi
   transport grpc default
      vrf MGMT
   provider eos-native

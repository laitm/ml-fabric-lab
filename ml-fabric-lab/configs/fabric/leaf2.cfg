!
! ==========================================================
! LEAF2
! - Role: VTEP leaf (no hosts attached in this topology)
! - Still participates in VLAN/VNI service for VLAN 10 (EVPN/VXLAN)
! ==========================================================
!
service routing protocols model multi-agent
hostname leaf2
username admin privilege 15 secret 0 admin
aaa authorization exec default local
vrf instance MGMT
ip routing vrf MGMT
!
interface Management0
   vrf MGMT
   ip address 172.20.20.22/24
   no shutdown
!
ip route vrf MGMT 0.0.0.0/0 172.20.20.1
!
snmp-server vrf MGMT
snmp-server community lab ro
!
ip routing
router general
   router-id ipv4 10.0.0.12
!
vlan 10
   name TENANT10
!
interface Loopback0
   ip address 10.0.0.12/32
interface Loopback1
   ip address 10.0.1.12/32
!
! --- Underlay uplinks (2 uplinks total) ---
interface Ethernet1
   description to-spine1-eth3
   no switchport
   mtu 9214
   ip address 172.16.0.8/31
   no shutdown
interface Ethernet2
   description to-spine2-eth3
   no switchport
   mtu 9214
   ip address 172.16.0.12/31
   no shutdown
!
! --- VXLAN mapping (VNI rule: 10<VLAN>) ---
interface Vxlan1
   vxlan source-interface Loopback1
   vxlan udp-port 4789
   vxlan vlan 10 vni 10010
!
router bgp 65102
   router-id 10.0.0.12
   !
   vlan 10
      rd 10.0.0.12:10010
      route-target import 65000:10010
      route-target export 65000:10010
      redistribute learned
   !
   neighbor UNDERLAY peer group
   neighbor UNDERLAY description UNDERLAY_EBGP_TO_SPINES
   neighbor UNDERLAY remote-as 65000
   neighbor UNDERLAY maximum-routes 12000
   !
   neighbor OVERLAY peer group
   neighbor OVERLAY description OVERLAY_EVPN_EBGP_TO_SPINES
   neighbor OVERLAY remote-as 65000
   neighbor OVERLAY update-source Loopback0
   neighbor OVERLAY ebgp-multihop 3
   neighbor OVERLAY send-community extended
   neighbor OVERLAY maximum-routes 12000
   !
   neighbor 172.16.0.9 peer group UNDERLAY
   neighbor 172.16.0.13 peer group UNDERLAY
   !
   neighbor 10.0.0.1 peer group OVERLAY
   neighbor 10.0.0.2 peer group OVERLAY
   !
   address-family ipv4
      neighbor UNDERLAY activate
      network 10.0.0.12/32
      network 10.0.1.12/32
   !
   address-family evpn
      neighbor OVERLAY activate
!
management api http-commands
   protocol http
   !
   vrf MGMT
      no shutdown

management api gnmi
   transport grpc default
      vrf MGMT
   provider eos-native
